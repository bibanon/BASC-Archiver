#!/usr/bin/env python
# -*- coding: utf-8 -*-
# BASC Imageboard Archiver GUI
from __future__ import print_function
from __future__ import absolute_import

from PySide import QtCore, QtGui

from gui.ui_mainwindow import Ui_MainWindow


class MainWindow(QtGui.QMainWindow, Ui_MainWindow):
    def __init__(self, parent=None):
        super(MainWindow, self).__init__(parent)
        self.setupUi(self)

        # setting up thread list
        model = QtGui.QStandardItemModel(5, 0)
        model.setHorizontalHeaderLabels(['Site', 'Board', 'Thead ID', 'Slug', 'Status'])
        self.threadList.setModel(model)
        self.threadList.verticalHeader().setVisible(False)  # hide row numbers
        self.threadList.horizontalHeader().setResizeMode(QtGui.QHeaderView.Stretch)

        # connecting slots
        self.actionAbout.triggered.connect(self.show_about)
        self.actionExit.triggered.connect(QtGui.qApp.quit)

        self.addThread.clicked.connect(self.add_thread)
        self.addFromClipboard.clicked.connect(self.add_from_clipboard)

    def show_about(self):
        QtGui.QMessageBox.about(self, 'BASC-Archiver', '<center><h1>BASC-Archiver</h1></center> The <b>BASC Archiver</b> is a Python library used to archive imageboard threads. It uses the 4chan API with the py4chan wrapper. Developers are free to use the BASC-Archiver library for some interesting third-party applications, as it is licensed under the LGPLv3.')

    def add_thread(self):
        text = self.threadUrl.text()
        single_download = self.singleDownload.isChecked()
        minutes = self.checkMinutes.value()
        if text:
            print('adding thread:', text)
            if single_download:
                print('  only downloading thread once')
            else:
                print('  checking thread every', minutes, 'minutes')
            self.threadUrl.clear()

    def add_from_clipboard(self):
        print('adding thread from clipboard')

if __name__ == '__main__':
    import sys
    app = QtGui.QApplication(sys.argv)
    window = MainWindow()
    window.setWindowTitle('BASC-Archiver')
    window.show()
    sys.exit(app.exec_())
